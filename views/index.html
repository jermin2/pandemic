<!DOCTYPE html>
<html>
    <head>
        <meta name="viewport" content="width=device-width" />

        <!-- colyseus.js client -->
        <script type="text/javascript" src="https://unpkg.com/colyseus.js@^0.14.0/dist/colyseus.js"></script>
    </head>
<body>
    <h1>Pandemic</h1>

    <div> Rooms</div>

    <input type="text" id="name">
    <button type="button" class="btn btn-primary">Join Room</button>

    <div id="messages"></div>
    <script>
        var host = window.document.location.host.replace(/:.*/, '');
        var client = new Colyseus.Client(location.protocol.replace("http", "ws") + "//" + host + (location.port ? ':'+location.port : ''));
    
        client.joinOrCreate("game").then(room => {
            console.log("joined");
            room.onStateChange.once(function(state) {
                console.log("initial room state: ", state);
            });

            // new room state
            room.onStateChange(function(state) {
                // triggered on each patch
            });

            //listen to patches coming from the server
            room.onMessage("messages", function(message) {
                var p = document.createElement("p");
                p.innerText = message;
                document.querySelector("#messages").appendChild(p);
            });
        })
    
    
    </script>
</body>
</html>